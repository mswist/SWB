<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>
    666173251200000&nbsp;
    Swiss&nbsp;
    Scottish Widows Bank&nbsp;
    WebCSR
    &nbsp;-&nbsp;Customer Solicitor (Legal Advisor)
    &nbsp;-&nbsp;[User ID:&nbsp;1&nbsp;-&nbsp;Branch:&nbsp;LTSBSWB]
  </title>
  <link rel="stylesheet" type="text/css" href="./xFMA_Solicitor/scottishwidowsbank.css">
  <link rel="stylesheet" type="text/css" href="./xFMA_Solicitor/styles.css">
  <script type="text/javascript" src="./xFMA_Solicitor/utilities.js.download"></script>
  <script type="text/javascript" src="./xFMA_Solicitor/information.js.download"></script>
  <link rel="stylesheet" type="text/css" href="./xFMA_Solicitor/jquery-ui.structure.min.css">
  <link rel="stylesheet" type="text/css" href="./xFMA_Solicitor/jquery-ui.theme.min.css">
  <script type="text/javascript" src="./xFMA_Solicitor/jquery.js.download"></script>
  <script type="text/javascript" src="./xFMA_Solicitor/jquery-ui.min.js.download"></script>
</head>

<body>
  <div id="container">
    <div id="container-inner">
      <div class="site-header">
        <div class="sw-site-logo"><img src="./xFMA_Solicitor/logo_bank.gif" alt="Scottish Widows Bank: preparation is everything" border="0" height="59" width="189"></div>
        <div class="header-search-area">
          <div class="float-right">&nbsp;</div>
          <div class="clear-both"></div>
          <div class="search-ribbon"><img src="./xFMA_Solicitor/ribbon_large.gif" alt="" height="48" width="303"></div>
        </div>
      </div>
      <div class="clearer"></div>
      <div id="head" class="clearfix">&nbsp;</div>
      <div id="content">
        <div class="leftcolumn">
          <script src="./xFMA_Solicitor/menu.js.download" type="text/javascript"></script>
          <script src="./xFMA_Solicitor/lockMonitoring.js.download" type="text/javascript"></script>
          <script language="JavaScript">
            <!--
            addLoadEvent(monitorForms);
            addLoadEvent(monitorLinks);
            addUnloadEvent(conditionallyReleaseAgentLock);
            timeOutControl();

            function timeOutControl() {
              setTimeout("timeOut()", (3600 - 60) * 1000);
            }

            function timeOut() {
              var windowWidth = 300;
              var windowHeight = 200;
              var x = (screen.width - windowWidth) / 2;
              var y = (screen.height - windowHeight) / 2;
              windowOptions = "toolbar=no,location=no,directories=no,status=no,menubar=no,resizable=yes,scrollbars=no,copyhistory=yes,width=" + windowWidth + ",height=" + windowHeight + ",screenX=" + x + ",screenY=" + y + ",left=" + x + ",top=" + y;
              timeOutWindow = this.open("", "timeOutWindow", windowOptions);
              timeOutWindow.document.open();
              htmlBuffer = '<html>';
              htmlBuffer += '<head><title>Time-out Warning</title><link rel="stylesheet" type="text/css" href="resources/css/popUp.css"></head>';
              htmlBuffer += '<body><p>You will automatically be logged out in 1 minutes if there is no further activity.</p>';
              htmlBuffer += '<form name="timeOutForm" method="post" action="timeOut.do">';
              htmlBuffer += '<div class="submit-wrapper" align="center">';
              htmlBuffer += '<input type="submit" class="button1" value="Continue" name="continue" onClick="window.opener.timeOutControl();">&nbsp;&nbsp;';
              htmlBuffer += '<input type="button" class="button2" value="Exit" name="exit" onClick="window.opener.location=' + "'logoff.do'" + '; window.close()";>';
              htmlBuffer += '</form></body></html>';
              timeOutWindow.document.write(htmlBuffer);
              timeOutWindow.document.close();
              timeOutWindow.focus();
            }
            // 
            -->
          </script>
          <div class="secure-side-nav">
            <div class="menu-heading" style="padding-bottom:4px;"><a href="#">Log Out</a></div>
            <div class="menu-heading">IFA Management</div>
            <ul>
              <!-- li><a href="app/registration" >New IFA</a></li-->
              <li><a href="#" name="monitored">New IFA</a></li>
              <li><a href="#" name="monitored">IFA Information</a></li>
              <li><a href="#" name="monitored">New 3rd Party</a></li>
              <li><a href="#" name="monitored">3rd Party Information</a></li>
              <li><a href="#" name="monitored">IFA Mortgage Entry Search</a></li>
            </ul>
            <div class="menu-heading">Illustrations</div>
            <ul>
              <li><a href="#" name="monitored">Illustration Search</a></li>
              <li><a href="#" name="monitored">Advised Illustration Search</a></li>
              <li><a href="#" name="monitored">New Illustration</a></li>
            </ul>
            <div class="menu-heading">Deposit Applications</div>
            <ul>
              <li><a href="#" name="monitored">Deposit Application Search</a></li>
              <li><a href="#" name="monitored">Personal Deposit Application</a></li>
              <li><a href="#" name="monitored">Non-Personal Deposit Application</a></li>
            </ul>
            <div class="menu-heading">Mortgage Applications</div>
            <ul>
              <li><a href="#" name="monitored" class="menu-selected">Mortgage Application Search</a></li>
            </ul>
            <div class="menu-heading">Case Management</div>
            <ul>
              <li><a href="#" name="monitored">Available Cases</a></li>
              <li><a href="#" name="monitored">Case Search</a></li>
            </ul>
            <div class="menu-heading">Admin Assistant Management</div>
            <ul>
              <li><a href="#">Add Admin Assistant</a></li>
              <li><a href="#">Remove Admin Assistant</a></li>
              <li><a href="#">Admin Assistant Information</a></li>
            </ul>
          </div>
        </div>
        <div class="centralrightcolumn">
          <div class="dl-wrapper">
            <dl>
              <dt>Application ID:</dt>
              <dd>666173251200000</dd>
              <dt>Applicant(s):</dt>
              <dd>Mr Mac Swiss&nbsp;</dd>
              <dt>Case ID:</dt>
              <dd><a name="monitored" href="#">666173251200000001</a></dd>
            </dl>
          </div>
          <table style="margin: 0pt;">
            <thead>
              <tr>
                <th style="cursor:pointer;" onclick="removeUnloadEvents(); window.location=&#39;applicationManagementOrig.do?_eventId=experianStatusHistory&amp;_flowExecutionKey=_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890&#39;;">Status History</th>
                <th style="cursor:pointer;" onclick="removeUnloadEvents(); window.location=&#39;applicationManagementOrig.do?_eventId=reprocessExperian&amp;_flowExecutionKey=_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890&#39;;">Reprocess (Experian)</th>
                <th style="cursor:pointer;" onclick="removeUnloadEvents(); window.location=&#39;applicationManagementOrig.do?_eventId=resubmitHunter&amp;_flowExecutionKey=_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890&#39;;">Resubmit (Hunter)</th>
                <th style="cursor:pointer;" onclick="removeUnloadEvents(); window.location=&#39;applicationManagementOrig.do?_eventId=commissionDetails&amp;_flowExecutionKey=_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890&#39;;">Commission Details</th>
                <th style="cursor:pointer;" onclick="removeUnloadEvents(); window.location=&#39;applicationManagementOrig.do?_eventId=notes&amp;_flowExecutionKey=_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890&#39;;">Notes</th>
                <th style="cursor:pointer;" onclick="removeUnloadEvents(); window.location=&#39;applicationManagementOrig.do?_eventId=affordability&amp;_flowExecutionKey=_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890&#39;;">Affordability Model</th>
                <th style="cursor:pointer;" onclick="removeUnloadEvents(); window.location=&#39;applicationManagementOrig.do?_eventId=feeCollection&amp;_flowExecutionKey=_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890&#39;;">Fee Collection</th>
              </tr>
            </thead>
            <thead>
              <tr>
                <th style="cursor:pointer;" onclick="removeUnloadEvents(); window.location=&#39;applicationManagementOrig.do?_eventId=mortgageDetails&amp;_flowExecutionKey=_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890&#39;;">Mortgage Details</th>
                <th style="cursor:pointer;" onclick="removeUnloadEvents(); window.location=&#39;applicationManagementOrig.do?_eventId=dip&amp;_flowExecutionKey=_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890&#39;;">Stage 1</th>
                <th style="cursor: default; background: #EAEAEA none repeat scroll 0%; border-bottom: 2px solid #EAEAEA;">Stage 2</th>
                <th style="cursor:pointer;" onclick="removeUnloadEvents(); window.location=&#39;applicationManagementOrig.do?_eventId=resubmitExperian&amp;_flowExecutionKey=_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890&#39;;">Resubmit (Experian)</th>
                <th style="cursor:pointer;" onclick="removeUnloadEvents(); window.location=&#39;applicationManagementOrig.do?_eventId=valuation&amp;_flowExecutionKey=_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890&#39;;">Valuation</th>
                <th style="cursor:pointer;" onclick="removeUnloadEvents(); window.location=&#39;applicationManagementOrig.do?_eventId=offer&amp;_flowExecutionKey=_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890&#39;;">Offer</th>
                <th style="cursor:pointer;" onclick="removeUnloadEvents(); window.location=&#39;applicationManagementOrig.do?_eventId=underwritingSummary&amp;_flowExecutionKey=_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890&#39;;">Underwriting Summary</th>
                <th style="cursor:pointer;" onclick="removeUnloadEvents(); window.location=&#39;applicationManagementOrig.do?_eventId=completion&amp;_flowExecutionKey=_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890&#39;;">Completion</th>
              </tr>
            </thead>
          </table>
          <table style="width:100%;">
            <tbody>
              <tr>
                <td>
                </td>
              </tr>
            </tbody>
          </table>
          <h1>
            <!-- 
  -->
          </h1>
          <br>
          <h1><span id="header-title" style="position:absolute;">Customer Solicitor (Legal Advisor) </span></h1>
          <br><br><br>
          <div class="message-box">
            <p>As your client has chosen our Lifetime Mortgage Further Advance product. They will need to seek legal advice to confirm that the product meets their need.</p>
          </div>
          <script type="text/javascript">
            var msPerDay = 86400000; // Milliseconds per day (24h*60m*60s*1000ms)
            var monthNameArray = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            var dayNameArray = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
            var dateFormat = "dd/MM/yyyy"; // Defines format for date string.
            var dateStringDelimiter = "";
            var patternElements = null;
            var calendarWindowClosed = true;
            var selectedDate = null; // Currently selected date.
            var dateField = null; // Reference to form field to pull/insert date.
            var windowWidth = 255;
            var windowHeight = 200;
            /* 
             * yearLogicCode:
             *0:2 digit years:
             *- between 100-50 considered as previous century year
             *- between 0-50 considered as current century year
             *1:2 digit years are considered as current century year
             * -1:2 digit years are considered as previous century year
             */
            var yearLogicCode = 0;
            /*
             * Open calendar window and draw calendar
             */
            function showCalendarByID(fieldID, defaultActualDate) {
              var dateString = "";

              dateField = document.getElementById(fieldID);

              // If date field is disabled, don't popUp calendar
              if (dateField.disabled) {
                return;
              }
              if (dateField != null) {
                dateString = dateField.value;
              }
              dateStringDelimiter = getDelimiter(dateFormat);
              setDatePattern(dateFormat, dateStringDelimiter);
              selectedDate = getDateFromString(dateString);
              if (selectedDate == -1) {
                if (defaultActualDate != null && defaultActualDate.toString().toUpperCase() == "TRUE") {
                  selectedDate = new Date(1687734000000);
                } else {
                  selectedDate = new Date(1615248000000);
                }
              }
              var x = (screen.width - windowWidth) / 2;
              var y = (screen.height - windowHeight) / 2;
              windowOptions = "toolbar=no,location=no,directories=no,status=no,menubar=no,resizable=yes,copyhistory=yes,width=" + windowWidth + ",height=" + windowHeight + ",screenX=" + x + ",screenY=" + y + ",left=" + x + ",top=" + y;
              calendarWindow = this.open("", "calendarWindow", windowOptions);
              calendarWindow.callingForm = this;
              calendarWindowClosed = false;
              redraw();
            }

            function showCalendar(formName, fieldName, defaultActualDate) {
              var dateString = "";

              dateField = getElement(formName, fieldName);

              // If date field is disabled, don't popUp calendar
              if (dateField.disabled) {
                return;
              }
              if (dateField != null) {
                dateString = dateField.value;
              }
              dateStringDelimiter = getDelimiter(dateFormat);
              setDatePattern(dateFormat, dateStringDelimiter);
              selectedDate = getDateFromString(dateString);
              if (selectedDate == -1) {
                if (defaultActualDate != null && defaultActualDate.toString().toUpperCase() == "TRUE") {
                  selectedDate = new Date(1687734000000);
                } else {
                  selectedDate = new Date(1615248000000);
                }
              }
              var x = (screen.width - windowWidth) / 2;
              var y = (screen.height - windowHeight) / 2;
              windowOptions = "toolbar=no,location=no,directories=no,status=no,menubar=no,resizable=yes,copyhistory=yes,width=" + windowWidth + ",height=" + windowHeight + ",screenX=" + x + ",screenY=" + y + ",left=" + x + ",top=" + y;
              calendarWindow = this.open("", "calendarWindow", windowOptions);
              calendarWindow.callingForm = this;
              calendarWindowClosed = false;
              redraw();
            } // End of showCalendar
            /*
             * Return date string delimiter
             */
            function getDelimiter(formatString) {
              formatString = formatString.toUpperCase();
              var i = formatString.length - 1;
              var chr = "";
              while (i > 0) {
                chr = formatString.charAt(i);
                if ((chr == 'M') || (chr == 'D') || (chr == 'Y')) {
                  --i;
                } else {
                  return chr;
                }
              }
              return "";
            } // End of getDelimiter
            /*
             * Return date object from date string.
             */
            function getDateFromString(dateString) {
              dateString = dateString.toUpperCase();
              if ((dateString.length < 4) && (patternElements.length < 3)) {
                return -1;
              }
              if (dateStringDelimiter != "") {
                var dateElements = dateString.split(dateStringDelimiter);
              } else {
                var dateStringLength = dateString.length;
                var currentPosition = 0;
                var dateElements = new Array();
                var dateElement = null;
                var tempLength = null;
                var patternElement = null;
                var i = 0;
                while (currentPosition < dateStringLength) {
                  patternElement = new String(patternElements[i]);
                  tempLength = parseInt(currentPosition + patternElement.length);
                  dateElement = dateString.substring(currentPosition, tempLength);
                  dateElements[i] = parseInt(dateElement);
                  currentPosition += patternElement.length;
                  ++i;
                }
              }
              dateElementsLength = dateElements.length;
              if (dateElementsLength < 3) {
                return -1;
              } else {
                for (var j = 0; j < dateElementsLength; ++j) {
                  patternElement = patternElements[j];
                  dateElement = dateElements[j];
                  if (patternElement.length != dateElement.length) {
                    if (patternElements[j] == 'D' || patternElements[j] == 'M') {
                      if (dateElement.length != 2) {
                        alert("Invalid date format.");
                        return -1;
                      }
                    } else {
                      if (patternElements[j] == 'DD' || patternElements[j] == 'MM') {
                        if (dateElement.length != 1) {
                          alert("Invalid date format.");
                          return -1;
                        }
                      } else {
                        alert("Invalid date format.");
                        return -1;
                      }
                    }
                  }
                  switch (patternElement) {
                    case "M":
                      var month = dateElements[j] - 1;
                      break;
                    case "MM":
                      var month = dateElements[j] - 1;
                      break;
                    case "MMM":
                      var month = getMonthFromName(dateElements[j]);
                      break;
                    case "D":
                      var date = dateElements[j];
                      break;
                    case "DD":
                      var date = dateElements[j];
                      break;
                    case "DDD":
                      var day = getDayFromName(dateElements[j]);
                      break; // Day cannot be set in Java Script
                    case "YY":
                      var year = parseInt(dateElements[j]);
                      break;
                    case "YYYY":
                      var year = dateElements[j];
                      break;
                    default:
                      alert("Invalid date format.");
                      return -1;
                  }
                }
              }
              // Normalize two digit year to 4 digit year
              /*
              if ((year < 100) && (year >= 50))
              year = year + 1900;
              if ((year < 50) && (year >= 0))
              year = year + 2000;
              */
              year = getYear(year);
              return new Date(year, month, date);
            } // End of getDateFromString
            /*
             * Return 4 digit year based on yearLogicCode
             */
            function getYear(year) {
              if (yearLogicCode == 0) {
                if ((year < 100) && (year >= 50)) {
                  return year + getPrvCentury();
                }
                if ((year < 50) && (year >= 0)) {
                  return year + getCrCentury();
                }
              }
              if (yearLogicCode == 1) {
                if ((year < 100)) {
                  return year + getCrCentury();
                }
              }
              if (yearLogicCode == -1) {
                if ((year < 100)) {
                  return year + getPrvCentury();
                }
              }
              return year;
            } // End of getYear
            function getPrvCentury() {
              var today = new Date();
              fullYear = today.getFullYear();
              yr = fullYear % 100;
              return ((fullYear - yr) - 100);
            }

            function getCrCentury() {
              var today = new Date();
              fullYear = today.getFullYear();
              yr = fullYear % 100;
              return (fullYear - yr);
            }
            /*
             * Return the number between 0-11 for given first three chars of month
             */
            function getMonthFromName(monthName) {
              if (monthName.length >= 3) {
                if (monthName.length > 3) {
                  monthName = monthName.substring(0, 3);
                }
                for (var i = 0; i < monthNameArray.length; ++i) {
                  if (monthNameArray[i].substr(0, 3).toUpperCase() == monthName) {
                    return i;
                  }
                }
              } else {
                return 0; // If monthName is null, return Jan as default month
              }
            } // End of getMonthFromName
            /*
             * Return the number between 0-6 for given first three chars of day
             */
            function getDayFromName(dayName) {
              if (dayName.length >= 3) {
                if (dayName.length > 3) {
                  dayName = dayName.substring(0, 3);
                }
                for (var i = 0; i < dayNameArray.length; ++i) {
                  if (dayNameArray[i].substr(0, 3).toUpperCase() == dayName) {
                    return i;
                  }
                }
              } else {
                return 0; // If dayName is null, return first day in list as default.
              }
            } // End of getDayFromName
            /*
             * Set the date pattern.
             */
            function setDatePattern(pattern, delimiter) {
              pattern = pattern.toUpperCase();
              if (delimiter != "") {
                patternElements = pattern.split(delimiter);
                return;
              }
              patternElements = new Array();
              len = pattern.length;
              // Each change in character sequence is a new pattern element
              prevChar = pattern.charAt(0)
              var i = 1;
              var j = 0;
              patternElement = prevChar;
              while (i <= len) {
                currentChar = pattern.charAt(i);
                if (currentChar == prevChar) {
                  patternElement += currentChar;
                } else {
                  patternElements[j] = patternElement;
                  ++j;
                  patternElement = currentChar;
                  prevChar = currentChar
                }
                ++i;
              }
            } // End of setDatePattern
            /*
             * Redraw the calendar
             */
            function redraw() {
              calendarWindow.callingForm = this;
              firstOfMonth = new Date(selectedDate.getFullYear(), selectedDate.getMonth(), 1);
              calendarWindow.document.open();
              drawCalendar(firstOfMonth);
              calendarWindow.document.write(htmlBuffer);
              calendarWindow.document.close();
              calendarWindow.callingForm = this;
              calendarWindow.focus();
            } // End of redraw
            /*
             * Fill calling form's date and month
             */
            function fillDate(date) {
              var m = selectedDate.getMonth();
              var y = selectedDate.getFullYear();
              selectedDate.setDate(date);
              dateString = getDateString();
              if (dateField != null) {
                dateString = dateField.value = dateString;
              } else {
                alert("Unable to find form element: " + dateField);
              }
              calendarWindowClosed = true;
              calendarWindow.close();
            } // End of fillDate
            /*
             * Return date string based on dateFormat from selectedDate date object.
             */
            function getDateString() {
              var patternElementsLength = patternElements.length;
              var dateString = "";
              var patternString = "";
              for (var i = 0; i < patternElementsLength; ++i) {
                patternString = new String(patternElements[i]).toUpperCase();
                switch (patternString) {
                  case "M":
                    var monthString = selectedDate.getMonth() + 1;
                    if (dateString == "") {
                      dateString = monthString;
                    } else {
                      dateString += dateStringDelimiter + monthString;
                    }
                    break;
                  case "MM":
                    var monthString = selectedDate.getMonth() + 1;
                    if (parseInt(monthString) < 10) {
                      monthString = '0' + monthString;
                    }
                    if (dateString == "") {
                      dateString = monthString;
                    } else {
                      dateString += dateStringDelimiter + monthString;
                    }
                    break;
                  case "MMM":
                    if (dateString == "") {
                      dateString = monthNameArray[selectedDate.getMonth()].substr(0, 3);
                    } else {
                      dateString += dateStringDelimiter + monthNameArray[selectedDate.getMonth()].substr(0, 3);
                    }
                    break;
                  case "D":
                    var dayString = selectedDate.getDate();
                    if (dateString == "") {
                      dateString = dayString;
                    } else {
                      dateString += dateStringDelimiter + dayString;
                    }
                    break;
                  case "DD":
                    var dayString = selectedDate.getDate();
                    if (parseInt(dayString) < 10) {
                      dayString = '0' + dayString;
                    }
                    if (dateString == "") {
                      dateString = dayString;
                    } else {
                      dateString += dateStringDelimiter + dayString;
                    }
                    break;
                  case "DDD":
                    if (dateString == "") {
                      dateString = dayNameArray[selectedDate.getDay()].substr(0, 3);
                    } else {
                      dateString += dateStringDelimiter + dayNameArray[selectedDate.getDay()].substr(0, 3);
                    }
                    break;
                  case "YY":
                    var yearString = selectedDate.getFullYear();
                    var yearLength = yearString.length;
                    if (parseInt(yearString) < 10) {
                      yearString = '0' + yearString;
                    }
                    if (parseInt(yearString) > 100) {
                      yearString = yearString.substr(yearLength - 2);
                    }
                    if (dateString == "") {
                      dateString = yearString;
                    } else {
                      dateString += dateStringDelimiter + yearString;
                    }
                    break;
                  case "YYYY":
                    var yearString = selectedDate.getFullYear()
                    if (parseInt(yearString) <= 100) {
                      yearString = '0' + yearString;
                    }
                    if (dateString == "") {
                      dateString = yearString;
                    } else {
                      dateString += dateStringDelimiter + yearString;
                    }
                    break;
                }
              }
              return dateString;
            } // End getDateString
            /*
             * Change month of selectedDate
             */
            function changeMonth(increment) {
              var newMonth = null;
              if (increment == 1) {
                newMonth = selectedDate.getMonth() + 1;
              }
              if (increment == -1) {
                newMonth = selectedDate.getMonth() - 1;
              }
              // Check if day of month is out of scope for new month
              var newDayOfMonth = selectedDate.getDate();
              selectedDate.setMonth(newMonth);
              // Check if going from Dec to Jan or vice versa and set newMonth accordingly.
              if (newMonth == 12) {
                newMonth = 0;
              } else if (newMonth == -1) {
                newMonth = 11;
              }
              while (selectedDate.getMonth() != newMonth) {
                --newDayOfMonth;
                selectedDate.setDate(newDayOfMonth);
                selectedDate.setMonth(newMonth);
              }
              redraw();
            } // End of changeMonth
            /*
             * Change year of selectedDate
             */
            function changeYear(increment) {
              var newYear = null;
              if (increment == 1) {
                newYear = selectedDate.getFullYear() + 1;
              }
              if (increment == -1) {
                newYear = selectedDate.getFullYear() - 1;
              }
              // Check if day of month is out of scope for month in new year (i.e. leap year)
              var currentMonth = selectedDate.getMonth();
              var newDayOfMonth = selectedDate.getDate();
              selectedDate.setFullYear(newYear);
              while (selectedDate.getMonth() != currentMonth) {
                --newDayOfMonth;
                selectedDate.setDate(newDayOfMonth);
                selectedDate.setMonth(currentMonth);
                selectedDate.setFullYear(newYear);
              }
              selectedDate.setDate(newDayOfMonth);
              selectedDate.setFullYear(newYear);
              redraw();
            } // End of changeYear
            /*
             * Generate html for calendar window
             */
            function drawCalendar(theDate) {
              var month = selectedDate.getMonth();
              var year = new String(selectedDate.getFullYear());
              htmlBuffer = "<html>";
              htmlBuffer += "\n\t<head>\n\t\t<title>Calendar</title>\n\t\t<link rel='stylesheet' type='text/css' href='resources/css/calendar.css'>\n\t</head>";
              htmlBuffer += "\n\t<body>\n\t\t<table class='calendar'>\n\t\t\t<tr>\n\t\t\t\t<td class='calendarMonthYearHeader'>";
              htmlBuffer += "\n\t\t\t\t\t<table width='100%' border='0' cellpadding='0' cellspacing='0' align='center'>";
              htmlBuffer += "\n\t\t\t\t\t\t<tr>";
              htmlBuffer += "\n\t\t\t\t\t\t\t<td class='calendarMonthYearHeader' onMouseOver=\"this.style.cursor='pointer';\" onClick='callingForm.changeMonth(-1);'><img src='images/arrowCalendarLeft.gif' width='5' height='10'></td>";
              htmlBuffer += "\n\t\t\t\t\t\t\t<td class='calendarMonthYearHeader' width='100%'>" + monthNameArray[month] + "</td>";
              htmlBuffer += "\n\t\t\t\t\t\t\t<td class='calendarMonthYearHeader' onMouseOver=\"this.style.cursor='pointer';\" onClick='callingForm.changeMonth(1);'><img src='images/arrowCalendarRight.gif' width='5' height='10'></td>";
              htmlBuffer += "\n\t\t\t\t\t\t\t<td>&nbsp;&nbsp;</td>";
              htmlBuffer += "\n\t\t\t\t\t\t\t<td class='calendarMonthYearHeader' onMouseOver=\"this.style.cursor='pointer';\" onClick='callingForm.changeYear(-1);'><img src='images/arrowCalendarLeft.gif' width='5' height='10'></td>";
              htmlBuffer += "\n\t\t\t\t\t\t\t<td class='calendarMonthYearHeader'>" + year + "</td>";
              htmlBuffer += "\n\t\t\t\t\t\t\t<td class='calendarMonthYearHeader' onMouseOver=\"this.style.cursor='pointer';\" onClick='callingForm.changeYear(1);'><img src='images/arrowCalendarRight.gif' width='5' height='10'></td>";
              htmlBuffer += "\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td>";
              htmlBuffer += "\n\t\t\t\t\t<table cellspacing='0' align='center' class='calendarBorder'>\n\t\t\t\t\t\t<tr>";
              for (var i = 0; i < dayNameArray.length; ++i) {
                htmlBuffer += "\n\t\t\t\t\t\t\t<td class='calendarDOWHeader'>" + dayNameArray[i].substring(0, 2) + "</td>";
              }
              htmlBuffer += "\n\t\t\t\t\t\t</tr>";
              drawBody(theDate);
              htmlBuffer += "\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t</body>\n</html>";
            }
            /*
             * Generate html layout with day numbers for calendar window
             */
            function drawBody(theDate) {
              thisMonth = theDate.getMonth();
              thisDate = theDate.getDate();
              theDate.setDate(1);
              // to avoid problems with daylight saving changes
              theDate.setHours(12);
              firstSunday(theDate);
              for (var w = 0; w < 6; ++w) {
                // Check if this will be a blank last week row
                if ((theDate.getMonth() != thisMonth) && (w != 0)) {
                  break;
                }
                htmlBuffer += "\n\t\t\t\t\t\t<tr>";
                for (var d = 0; d < 7; ++d) {
                  dayOfMonth = theDate.getDate();
                  if (thisMonth == theDate.getMonth()) {
                    if (dayOfMonth == selectedDate.getDate()) {
                      htmlBuffer += "\n\t\t\t\t\t\t\t<td align='center' class='calendarDaySelected' ";
                    } else {
                      htmlBuffer += "\n\t\t\t\t\t\t\t<td align='center' class='calendarDay' ";
                    }
                    htmlBuffer += "onMouseOver=\"this.style.cursor='pointer';\" onClick=\"callingForm.fillDate(" + dayOfMonth + ");\">";
                    // Pad zero for single digit day numbers
                    if (dayOfMonth < 10) {
                      htmlBuffer += "0";
                    }
                    htmlBuffer += dayOfMonth + "</td>";
                  } else {
                    htmlBuffer += "\n\t\t\t\t\t\t\t<td align='center' class='calendarDayNoFocus'>&nbsp;</td>";
                  }
                  // Increment the date
                  newTime = theDate.getTime() + msPerDay;
                  theDate.setTime(newTime);

                }
                htmlBuffer += "\n\t\t\t\t\t\t</tr>";
              }
            } // End of drawBody
            /*
             * Return date of first Sunday in calendar
             */
            function firstSunday(fromDate) {
              while (fromDate.getDay() != 0) {
                newTime = fromDate.getTime() - msPerDay;
                fromDate.setTime(newTime);
              }
            } // End of firstSunday
            /*
             * Close the calendar window
             */
            function closeCalendar() {
              if (!calendarWindowClosed) {
                calendarWindow.close();
              }
            } // End of closeCalendar
          </script>
          <script type="text/javascript" src="./xFMA_Solicitor/utilities.js.download"></script>
          <script type="text/javascript">
            addLoadEvent(initialize);

            function initialize() {
              document.getElementById("comment").style.visibility = 'hidden';
              setNrPartners();
            }

            function toggleFields(elem, display) {
              document.getElementById(elem).style.display = (display) ? "block" : "none";
            }

            function setNrPartners() {
              document.getElementById('numberOfPartners').value = 0;
            }
            var fieldValue;

            function fieldValueChanged() {
              fieldValue = true;
              document.getElementById('fieldValue').value = true;
            }

            function submitForm(frm, action) {
              if (fieldValue == true && (("8" == "11") ||
                  ("8" == "12") ||
                  ("8" == "13"))) {
                if (document.getElementById('comment').style.visibility != 'visible') {
                  confirmDialog('Offer Alert', 'Will you issue a New Offer?', function() {
                    document.getElementById('offerOption').value = true;
                    submitPage(frm, action);
                    $(this).dialog("close");
                  }, function() {
                    document.getElementById('comment').style.visibility = 'visible';
                    $(this).dialog("close");
                  });
                } else if (document.getElementById('commentText').value == "") {
                  alert("Please enter the reason for not issuing new offer");
                } else {
                  submitPage(frm, action);
                }
              } else {
                submitPage(frm, action);
              }
              return false;
            }

            function submitPage(frm, action) {
              if (getElement("actionForm", "customerSolicitor.completionDate") != null) {
                var compForm = getElement("actionForm", "customerSolicitor.completionDate").value;
                if (compForm) {
                  var splitDate = compForm.split('/');
                  var compDate = new Date();
                  compDate.setFullYear(splitDate[2], parseInt(splitDate[1], 10) - 1, splitDate[0]);
                  var today = new Date();
                  today.setTime("1684796400000");
                  if ((compDate.getTime() - today.getTime()) < (1000 * 60 * 60 * 24 * 7 * 2)) {
                    alert("Your completion is scheduled within two weeks of this application date.");
                  }
                }
              }
              submit(frm, action);
            }

            function submit(form, action) {
              removeUnloadEvents();
              document.getElementById('method').setAttribute("name", action);
              document.getElementById('flowForm').submit();
            }
          </script>
          <form name="actionForm" id="flowForm" method="post" action="#">
            <input type="hidden" name="_flowExecutionKey" value="_c51B48D77-505D-8B34-C197-E0B734BED634_k4DEA45D4-718C-A643-2470-E0028E56C890">
            <input type="hidden" name="offerOption" id="offerOption" value="false">
            <input type="hidden" name="fieldValue" id="fieldValue" value="false">
            <input type="hidden" id="method" name="temp" value="">
            <input type="hidden" property="applicationId" name="applicationId" value="666173251200000">
            <div class="element-wrapper">
              <img src="./xFMA_Solicitor/info_sm.gif" id="info-200000100130" class="info-image" alt="Click for Further Information" onclick="showInformationBox(this.id);">
              <label>Name of Acting Solicitor*:</label>
              <input type="text" name="customerSolicitor.solicitorName" maxlength="50" size="50" value="AADSDA" onchange="fieldValueChanged()" id="solicitorName">
            </div>
            <div class="element-wrapper">
              <label>SWB Solicitor Country:</label>
              <input type="text" name="customerSolicitor.country" maxlength="50" size="50" value="Poland" onchange="fieldValueChanged()">
            </div>
            <div class="element-wrapper">
              <label>Firm Name:</label>
              <input type="text" name="customerSolicitor.firmName" maxlength="50" size="50" value="ASDASA" onchange="fieldValueChanged()" id="firmName">
            </div>
            <div class="element-wrapper">
              <label>Number of Partner(s) in Firm:</label>
              <select name="customerSolicitor.numberOfPartners" onchange="fieldValueChanged()" id="numberOfPartners">
                <option value=""></option>
                <option value="0">0</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9+</option>
              </select>
            </div>
            <div class="element-wrapper">
              <label>Building name:</label>
              <input type="text" name="customerSolicitor.address.addressLine1" maxlength="40" size="40" value="fsd" onchange="fieldValueChanged()" id="addressLine1">
            </div>
            <div class="element-wrapper">
              <label>Building number:</label>
              <input type="text" name="customerSolicitor.address.addressLine2" maxlength="40" size="40" value="" onchange="fieldValueChanged()" id="addressLine2">
            </div>
            <div class="element-wrapper">
              <label>Street name:</label>
              <input type="text" name="customerSolicitor.address.addressLine3" maxlength="40" size="40" value="" onchange="fieldValueChanged()" id="addressLine3">
            </div>
            <div class="element-wrapper">
              <label></label>
              <input type="text" name="customerSolicitor.address.addressLine4" maxlength="40" size="40" value="" onchange="fieldValueChanged()" id="addressLine4">
            </div>
            <div class="element-wrapper">
              <label>Town/City:</label>
              <input type="text" name="customerSolicitor.address.town" maxlength="40" size="40" value="sdf" onchange="fieldValueChanged()" id="town">
            </div>
            <div class="element-wrapper">
              <label>Postcode:</label>
              <input type="text" name="customerSolicitor.address.postCode" maxlength="8" size="8" value="SL4 4BD" onchange="fieldValueChanged()" id="postCode">
            </div>
            <div class="element-wrapper">
              <label>DX Address:</label>
              <input type="text" name="customerSolicitor.dxAddress" maxlength="40" size="40" value="" onchange="fieldValueChanged()" id="dxAddress">
            </div>
            <div class="element-wrapper">
              <label>LP Address:</label>
              <input type="text" name="customerSolicitor.lpAddress" maxlength="40" size="40" value="" onchange="fieldValueChanged()" id="lpAddress">
            </div>
            <div class="element-wrapper">
              <label>Telephone Number:</label>
              <input type="text" name="customerSolicitor.telephone" maxlength="11" size="13" value="" onchange="fieldValueChanged()" id="telephone">
            </div>
            <div class="element-wrapper">
              <label>FAX:</label>
              <input type="text" name="customerSolicitor.faxNumber" maxlength="11" size="13" value="" onchange="fieldValueChanged()" id="faxNumber">
            </div>
            <div class="element-wrapper">
              <label>Email Address:</label>
              <input type="text" name="customerSolicitor.emailAddress" maxlength="55" size="55" value="" onchange="fieldValueChanged()" id="emailAddress">
            </div>
            <div class="element-wrapper">
              <label>Completion Date:</label>
              <input type="text" name="customerSolicitor.completionDate" maxlength="10" size="12" value="" onchange="fieldValueChanged()">
              <a href="javascript:showCalendar(&#39;actionForm&#39;,&#39;customerSolicitor.completionDate&#39;);"><img src="./xFMA_Solicitor/calendar.gif" onclick="fieldValueChanged()"></a>
              &nbsp;&nbsp;<span class="tagFormat">(dd/mm/yyyy)</span>
            </div>
            <div class="element-wrapper" id="comment" style="visibility: hidden;">
              <label>Reason for not issuing Re-Offer&nbsp;<span class="ast">*</span>:</label>
              <input type="text" name="commentForNotIssuingOffer" size="35" maxlength="55" id="commentText">
            </div>
            <div class="clear-both"></div>
            <div class="submit-wrapper3">
              <div class="submit"><input type="submit" name="_eventId_submit" id="open" onclick="return submitForm(this.form, this.name);" value="Next"></div>
              <div class="back"><input type="submit" name="_eventId_back" value="Back"></div>
              <div class="cancel"><input type="submit" name="_eventId_cancel" value="Exit"></div>
              <div class="clearer"></div>
            </div>
          </form>
        </div>
      </div>
      <div id="footer">
        <h2 id="footer-header"><span class="cursor">&nbsp;</span></h2>
      </div>
      <div id="copyright">
        <p>Copyright © 2023 Scottish Widows</p>
      </div>
    </div>
  </div>
</body>

</html>